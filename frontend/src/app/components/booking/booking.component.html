<!-- Booking Modal -->
<div class="modal-overlay" *ngIf="showModal" (click)="closeModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <span class="close-btn" (click)="closeModal()">&times;</span>
    <h2>Book your car</h2>

    <form (ngSubmit)="onSubmit()">

      <label for="username">Full Name:</label>
      <input type="text" id="username" [(ngModel)]="bookingData.username" name="username" required />

      <label for="carName">Car Name:</label>
      <input type="text" id="carName" [(ngModel)]="bookingData.carName" name="carName" readonly />

      <div class="form-group">
        <label for="userEmail">Email:</label>
        <input type="email"
              id="userEmail"
              name="userEmail"
              [(ngModel)]="bookingData.userEmail"
              required
              pattern="[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}"
              [disabled]="true"
              class="form-control">
      </div>

      <div class="form-group">
        <label for="phone">Phone Number:</label>
        <input type="tel"
              id="phone"
              name="phone"
              [(ngModel)]="bookingData.phone"
              required
              pattern="^(\+216[2459]\d{7}|[29]\d{7}|0)$"
              title="Enter a valid Tunisian number (e.g., +21612345678 or 99123456)"
              class="form-control">
      </div>

      <label for="description">Description:</label>
      <textarea id="description" [(ngModel)]="bookingData.description" name="description"></textarea>

      <!-- Start Date with X button -->
      <div class="datepicker-wrapper">
        <label for="startDate">Start Date <span style="color: red;">(Must be today or later)</span></label>
        <div class="input-with-x">
          <input type="text"
                id="startDate"
                [(ngModel)]="bookingData.startDate"
                name="startDate"
                bsDatepicker
                #startDp="bsDatepicker"
                [bsConfig]="{ dateInputFormat: 'YYYY-MM-DD', minDate: today, datesDisabled: unavailableDates }"
                readonly
                (keydown)="$event.preventDefault()"
                required
                (ngModelChange)="calculateDaysAndPrice()"/>
          <button type="button" class="x-btn" (click)="startDp.hide()">✖</button>
        </div>
      </div>

      <!-- End Date with X button -->
      <div class="datepicker-wrapper">
        <label for="endDate">End Date <span style="color: red;">(Must be after the start date)</span></label>
        <div class="input-with-x">
          <input type="text"
                id="endDate"
                [(ngModel)]="bookingData.endDate"
                name="endDate"
                bsDatepicker
                #endDp="bsDatepicker"
                [bsConfig]="{ dateInputFormat: 'YYYY-MM-DD', minDate: today, datesDisabled: unavailableDates }"
                readonly
                (keydown)="$event.preventDefault()"
                required
                (ngModelChange)="calculateDaysAndPrice()"/>
          <button type="button" class="x-btn" (click)="endDp.hide()">✖</button>
        </div>
      </div>

      <p><strong>Agency:</strong> {{ bookingData.agence }}</p>

      <p><strong>Number of Days:</strong> {{ bookingData.nbrJrs }}</p>

      <p><strong>Total Price:</strong> DT {{ bookingData.price }}</p>

      <label for="pickupLocation">Pick-up Location:</label>
      <input type="text" id="pickupLocation" [(ngModel)]="bookingData.pickupLocation" name="pickupLocation" required />

      <label for="dropoffLocation">Drop-off Location:</label>
      <input type="text" id="dropoffLocation" [(ngModel)]="bookingData.dropoffLocation" name="dropoffLocation" required />

      <button type="submit">Confirm Reservation</button>
    </form>

    <p *ngIf="responseMessage">{{ responseMessage }}</p>
  </div>
</div>
